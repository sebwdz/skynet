{
	"managers" : {
		"mainRequest" : {
			"type" : "request",
			"request" : {
				"select" : ["movies.id \"movies.id\""],
				"from" : ["movies"]
			}
		},
		"dataRequest" : {
				"type" : "request",
				"request" : {
				"from" : ["preferences"],
				"select" : [
					"preferences.likes \"preferences.likes\"",
					"users.age / 20.0 \"users.age\"",
					"users.gender \"users.gender\"",
					"opinions.rate \"opinions.rate\""],
				"joins" : [{
					"table" : "opinions as opinions",
					"on" : {
						"type" : "equal",
						"right" : ":movies.id",
						"left" : "opinions.fk_movie_id"
					}
				}, {
					"table" : "users",
					"on" : {
						"type" : "equal",
						"right" : "users.id",
						"left" : "opinions.fk_user_id"
					}
				}],
				"where" : {
					"type" : "equal",
					"left" : "preferences.fk_user_id",
					"right" : "users.id"
				}
			}
		},
		"importManager" : {
			"type" : "interpreter",
			"fields" : {
				"inputs" : [{
					"type" : "json",
					"from" : [{
						"column" : "preferences.likes",
						"fields" : [
							"Mystery", "Drama", "Sci-Fi", "Fantasy", "Unknown", 
			       			"Horror", "Film-Noir", "Crime", "Romance", "Childrens", 
			       			"Musical", "Animation", "Western", "Action", "Comedy", 
			       			"Documentary", "War", "Thriller", "Adventure"
						]
					}]
				}, {
						"type" : "bool",
						"from" : [{"column" : "users.gender"}]
					}, {
						"type" : "double",
						"from" : [{"column" : "users.age"}]
				}],
				"outputs" : [{
					"type" : "double",
					"from" : [{"column" : "opinions.rate"}]
				}]
			}
		},
		"networkManager" : {
			"type" : "network",
			"session_type" : "learn",
			"network" : {
				"settings" : {
					"type" : "SelfOrganizingMap",
					"inputs" : 21, 
					"outputs" : [4, 4],
					"outputs_type" : "average"
				},
				"session" : {
					"iterations" : 2000
				}
			}
		},
		"exportManager" : {
			"type" : "exporter",
			"table" : "networks",
			"main_keys" : ["type", "fk_id"],
			"fields" : {
				"fk_id" : ":movies.id",
				"map" : ":network",
				"settings" : { 
					"request_id" : 1
				},
				"type" : "movieslike"
			}
		}
	},
	"process" : [{
			"call" : "mainRequest",
			"type" : "forone",
			"save" : ["movies.id"],
			"to" : [{
				"call" : "dataRequest",
				"type" : "forall",
				"to" : [{
					"call" : "importManager",
					"type" : "forall",
					"to" : [{
						"call" : "networkManager",
						"type" : "forall",
						"to" : [{
							"call" : "exportManager"
						}]
					}]
				}]
			}]
		}
	]
}